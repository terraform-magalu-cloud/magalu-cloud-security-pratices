{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"index.html","title":"Welcome to the Magalu Cloud Pratices","text":"<p>This site provides a comprehensive, community-driven collection of security policies for Magalu Cloud, implemented as Policy-as-Code.</p> <p>Our goal is to translate the official Magalu Cloud Security Best Practices into automated, enforceable rules. This allows development and operations teams to validate their infrastructure-as-code against recommended security controls before deployment.</p> <p>All policies are written in Rego, the policy language for the Open Policy Agent (OPA), and are designed to be used with tools like Conftest to validate Terraform plans.</p> <p>From Best Practices to Enforceable Code</p> <p>The official Magalu Cloud documentation provides essential guidance on securing your cloud environment. This project takes that guidance a step further by providing the code to automatically check for compliance, bridging the gap between documentation and implementation.</p> <p>Community Driven</p> <p>This is an open-source project, and contributions are welcome! Please see the <code>CONTRIBUTING.md</code> file in our GitHub repository for details on how to contribute.</p>"},{"location":"index.html#getting-started","title":"Getting Started","text":"<p>To explore the security controls, use the \"Policies\" menu in the navigation bar above. The policies are organized by service category.</p>"},{"location":"index.html#how-to-use-these-policies","title":"How to Use These Policies","text":"<p>These policies are designed to be integrated directly into your CI/CD pipelines to provide automated security feedback on your Terraform code.</p> <ol> <li> <p>Explore the Policies: Use the navigation menu to browse the rules. Each policy page provides a description of the risk, its severity, and a link to the source code.</p> </li> <li> <p>Integrate with Conftest: You can use this repository to test your Terraform plans against the official best practices.</p> <pre><code># 1. Generate a Terraform plan in JSON format\nterraform plan -out=tfplan.binary\nterraform show -json tfplan.binary &gt; tfplan.json\n\n# 2. Run Conftest against the plan using all policies\nconftest test --policy path/to/magalu-cloud-security-pratices/policy/rego/mgc/ tfplan.json\n</code></pre> <p>A non-zero exit code indicates that one or more security policies have been violated, which can be used to fail a pipeline build.</p> </li> </ol>"},{"location":"policies/database.html","title":"Database Policies","text":""},{"location":"policies/database.html#mgcdb001-ensure-minimum-backup-retention-for-dbaas-instances","title":"MGC.DB.001: Ensure minimum backup retention for DBaaS Instances","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Database</code></p> <p>Description: Detects DBaaS instances ('mgc_dbaas_instances') with a backup retention period of less than 7 days.</p>"},{"location":"policies/database.html#source-code-mgc_db_instance_ensure_minimum_backup_retentionrego","title":"Source Code: mgc_db_instance_ensure_minimum_backup_retention.rego","text":""},{"location":"policies/database.html#mgcdb002-ensure-minimum-backup-retention-for-dbaas-clusters","title":"MGC.DB.002: Ensure minimum backup retention for DBaaS Clusters","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Database</code></p> <p>Description: Detects DBaaS clusters ('mgc_dbaas_clusters') with a backup retention period of less than 7 days.</p>"},{"location":"policies/database.html#source-code-mgc_db_cluster_ensure_minimum_backup_retentionrego","title":"Source Code: mgc_db_cluster_ensure_minimum_backup_retention.rego","text":""},{"location":"policies/database.html#mgcdb003-disallow-manual-snapshots-of-dbaas-instances","title":"MGC.DB.003: Disallow manual snapshots of DBaaS Instances","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Database</code></p> <p>Description: Detects the use of manual snapshots ('mgc_dbaas_instances_snapshots'). Automated backups are preferred.</p>"},{"location":"policies/database.html#source-code-mgc_db_disallow_manual_snapshotsrego","title":"Source Code: mgc_db_disallow_manual_snapshots.rego","text":""},{"location":"policies/database.html#mgcdb004-ensure-dbaas-parameter-groups-have-a-description","title":"MGC.DB.004: Ensure DBaaS Parameter Groups have a description","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Database</code></p> <p>Description: Detects DBaaS parameter groups ('mgc_dbaas_parameter_groups') created without a description.</p>"},{"location":"policies/database.html#source-code-mgc_db_ensure_parameter_group_descriptionrego","title":"Source Code: mgc_db_ensure_parameter_group_description.rego","text":""},{"location":"policies/database.html#mgcdb005-ensure-dbaas-instances-use-custom-parameter-groups","title":"MGC.DB.005: Ensure DBaaS Instances use custom Parameter Groups","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Database</code></p> <p>Description: Detects DBaaS instances ('mgc_dbaas_instances') that do not specify a 'parameter_group', thus using the system default.</p>"},{"location":"policies/database.html#source-code-mgc_db_instance_ensure_custom_parameter_grouprego","title":"Source Code: mgc_db_instance_ensure_custom_parameter_group.rego","text":""},{"location":"policies/database.html#mgcdb006-ensure-dbaas-clusters-use-custom-parameter-groups","title":"MGC.DB.006: Ensure DBaaS Clusters use custom Parameter Groups","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Database</code></p> <p>Description: Detects DBaaS clusters ('mgc_dbaas_clusters') that do not specify a 'parameter_group', thus using the system default.</p>"},{"location":"policies/database.html#source-code-mgc_db_cluster_ensure_custom_parameter_grouprego","title":"Source Code: mgc_db_cluster_ensure_custom_parameter_group.rego","text":""},{"location":"policies/kubernetes.html","title":"Kubernetes Policies","text":""},{"location":"policies/kubernetes.html#mgck8s001-restrict-kubernetes-cluster-api-access","title":"MGC.K8S.001: Restrict Kubernetes Cluster API access","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Kubernetes</code></p> <p>Description: Detects Kubernetes clusters ('mgc_kubernetes_cluster') that do not define 'allowed_cidrs' or that allow unrestricted access.</p>"},{"location":"policies/kubernetes.html#source-code-mgc_k8s_restrict_api_accessrego","title":"Source Code: mgc_k8s_restrict_api_access.rego","text":""},{"location":"policies/kubernetes.html#mgck8s002-ensure-kubernetes-clusters-have-a-description","title":"MGC.K8S.002: Ensure Kubernetes Clusters have a description","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Kubernetes</code></p> <p>Description: Detects Kubernetes clusters ('mgc_kubernetes_cluster') created without a description.</p>"},{"location":"policies/kubernetes.html#source-code-mgc_k8s_ensure_cluster_descriptionrego","title":"Source Code: mgc_k8s_ensure_cluster_description.rego","text":""},{"location":"policies/kubernetes.html#mgck8s003-ensure-anti-affinity-for-kubernetes-control-plane","title":"MGC.K8S.003: Ensure anti-affinity for Kubernetes control plane","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Kubernetes</code></p> <p>Description: Detects clusters ('mgc_kubernetes_cluster') that explicitly disable anti-affinity ('enabled_server_group = false').</p>"},{"location":"policies/kubernetes.html#source-code-mgc_k8s_enforce_anti_affinityrego","title":"Source Code: mgc_k8s_enforce_anti_affinity.rego","text":""},{"location":"policies/kubernetes.html#mgck8s004-ensure-logical-nodepool-autoscaling-configuration","title":"MGC.K8S.004: Ensure logical Nodepool autoscaling configuration","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Kubernetes</code></p> <p>Description: Detects nodepools ('mgc_kubernetes_nodepool') where 'min_replicas' is greater than or equal to 'max_replicas'.</p>"},{"location":"policies/kubernetes.html#source-code-mgc_k8s_ensure_nodepool_autoscaling_configrego","title":"Source Code: mgc_k8s_ensure_nodepool_autoscaling_config.rego","text":""},{"location":"policies/kubernetes.html#mgck8s005-ensure-nodepools-use-multiple-availability-zones-az","title":"MGC.K8S.005: Ensure Nodepools use multiple Availability Zones (AZ)","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Kubernetes</code></p> <p>Description: Detects nodepools ('mgc_kubernetes_nodepool') that specify 'availability_zones' but list fewer than two zones.</p>"},{"location":"policies/kubernetes.html#source-code-mgc_k8s_ensure_nodepool_multi_azrego","title":"Source Code: mgc_k8s_ensure_nodepool_multi_az.rego","text":""},{"location":"policies/loadbalancer.html","title":"Loadbalancer Policies","text":""},{"location":"policies/loadbalancer.html#mgclb001-ensure-external-load-balancers-use-tls-https","title":"MGC.LB.001: Ensure external Load Balancers use TLS (HTTPS)","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Load Balancer</code></p> <p>Description: Detects Load Balancers ('mgc_lbaas_network') with 'visibility = external' that do not have any 'tls' listener configured.</p>"},{"location":"policies/loadbalancer.html#source-code-mgc_lb_ensure_external_uses_tlsrego","title":"Source Code: mgc_lb_ensure_external_uses_tls.rego","text":""},{"location":"policies/loadbalancer.html#mgclb002-ensure-tls-listeners-have-an-associated-certificate","title":"MGC.LB.002: Ensure TLS listeners have an associated certificate","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Load Balancer</code></p> <p>Description: Detects listeners ('mgc_lbaas_network.listeners') with 'protocol = tls' that do not have a 'tls_certificate_name' defined.</p>"},{"location":"policies/loadbalancer.html#source-code-mgc_lb_ensure_tls_listener_has_certrego","title":"Source Code: mgc_lb_ensure_tls_listener_has_cert.rego","text":""},{"location":"policies/loadbalancer.html#mgclb003-ensure-load-balancer-backends-have-health-checks","title":"MGC.LB.003: Ensure Load Balancer backends have Health Checks","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Load Balancer</code></p> <p>Description: Detects backends ('mgc_lbaas_network') that do not have a 'health_check_name' associated.</p>"},{"location":"policies/loadbalancer.html#source-code-mgc_lb_ensure_backend_health_checkrego","title":"Source Code: mgc_lb_ensure_backend_health_check.rego","text":""},{"location":"policies/loadbalancer.html#mgclb004-ensure-external-load-balancers-have-a-public-ip","title":"MGC.LB.004: Ensure external Load Balancers have a Public IP","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Load Balancer</code></p> <p>Description: Detects external Load Balancers ('mgc_lbaas_network') that do not have a 'public_ip_id' associated.</p>"},{"location":"policies/loadbalancer.html#source-code-mgc_lb_ensure_external_lb_has_public_iprego","title":"Source Code: mgc_lb_ensure_external_lb_has_public_ip.rego","text":""},{"location":"policies/network.html","title":"Network Policies","text":""},{"location":"policies/network.html#mgcnet001-public-ssh-access-is-not-allowed","title":"MGC.NET.001: Public SSH access is not allowed","text":"<p>Severity: !!! critical \"CRITICAL\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects security group ingress rules that allow unrestricted access to SSH (port 22).</p>"},{"location":"policies/network.html#source-code-mgc_network_deny_public_sshrego","title":"Source Code: mgc_network_deny_public_ssh.rego","text":""},{"location":"policies/network.html#mgcnet002-public-rdp-access-is-not-allowed","title":"MGC.NET.002: Public RDP access is not allowed","text":"<p>Severity: !!! critical \"CRITICAL\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects security group ingress rules that allow unrestricted access to RDP (port 3389).</p>"},{"location":"policies/network.html#source-code-mgc_network_deny_public_rdprego","title":"Source Code: mgc_network_deny_public_rdp.rego","text":""},{"location":"policies/network.html#mgcnet003-public-ssh-access-over-ipv6-is-not-allowed","title":"MGC.NET.003: Public SSH access over IPv6 is not allowed","text":"<p>Severity: !!! critical \"CRITICAL\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects security group ingress rules that allow unrestricted access from any IPv6 address (::/0) to SSH (port 22).</p>"},{"location":"policies/network.html#source-code-mgc_network_deny_public_ssh_ipv6rego","title":"Source Code: mgc_network_deny_public_ssh_ipv6.rego","text":""},{"location":"policies/network.html#mgcnet004-security-group-rule-without-description","title":"MGC.NET.004: Security Group Rule without description","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects Security Group Rules created without a description.</p>"},{"location":"policies/network.html#source-code-mgc_network_ensure_rule_descriptionrego","title":"Source Code: mgc_network_ensure_rule_description.rego","text":""},{"location":"policies/network.html#mgcnet005-security-group-without-description","title":"MGC.NET.005: Security Group without description","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects Security Groups created without a description.</p>"},{"location":"policies/network.html#source-code-mgc_network_ensure_group_descriptionrego","title":"Source Code: mgc_network_ensure_group_description.rego","text":""},{"location":"policies/network.html#mgcnet006-block-unrestricted-public-access-to-sensitive-ports","title":"MGC.NET.006: Block unrestricted public access to sensitive ports","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects rules that expose a list of well-known sensitive ports to the public internet.</p>"},{"location":"policies/network.html#source-code-mgc_network_deny_public_sensitive_portsrego","title":"Source Code: mgc_network_deny_public_sensitive_ports.rego","text":""},{"location":"policies/network.html#mgcnet007-block-publicly-exposed-port-ranges","title":"MGC.NET.007: Block publicly exposed port ranges","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects security rules that expose a range of ports (more than one) to the public internet.</p>"},{"location":"policies/network.html#source-code-mgc_network_deny_public_port_rangerego","title":"Source Code: mgc_network_deny_public_port_range.rego","text":""},{"location":"policies/network.html#mgcnet008-block-allow-all-public-security-rules","title":"MGC.NET.008: Block 'Allow All' public security rules","text":"<p>Severity: !!! critical \"CRITICAL\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects security rules that allow all traffic from all ports from the public internet.</p>"},{"location":"policies/network.html#source-code-mgc_network_deny_all_traffic_publicrego","title":"Source Code: mgc_network_deny_all_traffic_public.rego","text":""},{"location":"policies/network.html#mgcnet009-ensure-security-groups-disable-default-rules","title":"MGC.NET.009: Ensure Security Groups disable default rules","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects 'mgc_network_security_groups' that do not set 'disable_default_rules = true'.</p>"},{"location":"policies/network.html#source-code-mgc_network_enforce_disable_default_rulesrego","title":"Source Code: mgc_network_enforce_disable_default_rules.rego","text":""},{"location":"policies/network.html#mgcnet010-block-unknown-ports-exposed-publicly","title":"MGC.NET.010: Block unknown ports exposed publicly","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects security rules that expose non-standard web ports (other than 80, 443) to the public internet.</p>"},{"location":"policies/network.html#source-code-mgc_network_deny_public_unknown_portsrego","title":"Source Code: mgc_network_deny_public_unknown_ports.rego","text":""},{"location":"policies/network.html#mgcnet011-detect-overly-broad-internal-access-to-database-ports","title":"MGC.NET.011: Detect overly broad internal access to database ports","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects rules that allow access from very wide private CIDRs to database ports.</p>"},{"location":"policies/network.html#source-code-mgc_network_restrict_wide_internal_db_accessrego","title":"Source Code: mgc_network_restrict_wide_internal_db_access.rego","text":""},{"location":"policies/network.html#mgcnet012-ensure-vpcs-have-a-description","title":"MGC.NET.012: Ensure VPCs have a description","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects 'mgc_network_vpcs' created without a 'description'.</p>"},{"location":"policies/network.html#source-code-mgc_network_ensure_vpc_descriptionrego","title":"Source Code: mgc_network_ensure_vpc_description.rego","text":""},{"location":"policies/network.html#mgcnet013-ensure-subnets-have-a-description","title":"MGC.NET.013: Ensure Subnets have a description","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects 'mgc_network_vpcs_subnets' created without a 'description'.</p>"},{"location":"policies/network.html#source-code-mgc_network_ensure_subnet_descriptionrego","title":"Source Code: mgc_network_ensure_subnet_description.rego","text":""},{"location":"policies/network.html#mgcnet014-restrict-subnets-with-overly-large-network-masks","title":"MGC.NET.014: Restrict Subnets with overly large network masks","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects 'mgc_network_vpcs_subnets' with a CIDR mask larger than /20.</p>"},{"location":"policies/network.html#source-code-mgc_network_restrict_large_subnet_maskrego","title":"Source Code: mgc_network_restrict_large_subnet_mask.rego","text":""},{"location":"policies/network.html#mgcnet015-ensure-subnets-have-explicit-dns-servers","title":"MGC.NET.015: Ensure Subnets have explicit DNS servers","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects 'mgc_network_vpcs_subnets' that do not define 'dns_nameservers' explicitly.</p>"},{"location":"policies/network.html#source-code-mgc_network_ensure_subnet_dnsrego","title":"Source Code: mgc_network_ensure_subnet_dns.rego","text":""},{"location":"policies/network.html#mgcnet016-ensure-vpc-interfaces-are-associated-with-a-subnet","title":"MGC.NET.016: Ensure VPC Interfaces are associated with a Subnet","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Network</code></p> <p>Description: Detects 'mgc_network_vpcs_interfaces' created without an association to 'subnet_ids'.</p>"},{"location":"policies/network.html#source-code-mgc_network_ensure_interface_has_subnetrego","title":"Source Code: mgc_network_ensure_interface_has_subnet.rego","text":""},{"location":"policies/storage.html","title":"Storage Policies","text":""},{"location":"policies/storage.html#mgcstorage001-ensure-storage-volumes-are-encrypted","title":"MGC.STORAGE.001: Ensure Storage volumes are encrypted","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects volumes ('mgc_block_storage_volumes') that are not configured for encryption at rest.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_enforce_volume_encryptionrego","title":"Source Code: mgc_storage_enforce_volume_encryption.rego","text":""},{"location":"policies/storage.html#mgcstorage002-ensure-minimum-snapshot-retention","title":"MGC.STORAGE.002: Ensure minimum snapshot retention","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects snapshot schedules ('mgc_block_storage_schedule') with a retention period of less than 7 days.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_ensure_minimum_retentionrego","title":"Source Code: mgc_storage_ensure_minimum_retention.rego","text":""},{"location":"policies/storage.html#mgcstorage003-ensure-snapshot-schedules-have-a-description","title":"MGC.STORAGE.003: Ensure snapshot schedules have a description","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects snapshot schedules ('mgc_block_storage_schedule') created without a description.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_ensure_schedule_descriptionrego","title":"Source Code: mgc_storage_ensure_schedule_description.rego","text":""},{"location":"policies/storage.html#mgcstorage004-disallow-manual-block-storage-snapshots","title":"MGC.STORAGE.004: Disallow manual Block Storage snapshots","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects the use of manual snapshots ('mgc_block_storage_snapshots'). Use 'mgc_block_storage_schedule' for automation.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_disallow_manual_snapshotsrego","title":"Source Code: mgc_storage_disallow_manual_snapshots.rego","text":""},{"location":"policies/storage.html#mgcstorage005-discourage-creating-volumes-from-snapshots-via-terraform","title":"MGC.STORAGE.005: Discourage creating volumes from snapshots via Terraform","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects volumes ('mgc_block_storage_volumes') created from a snapshot, which can indicate a manual recovery process coded into infrastructure.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_disallow_volume_from_snapshotrego","title":"Source Code: mgc_storage_disallow_volume_from_snapshot.rego","text":""},{"location":"policies/storage.html#mgcstorage006-disallow-public-read-access-on-object-storage-buckets","title":"MGC.STORAGE.006: Disallow public read access on Object Storage Buckets","text":"<p>Severity: !!! critical \"CRITICAL\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects 'mgc_object_storage_buckets' that allow public read access.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_deny_public_readrego","title":"Source Code: mgc_storage_deny_public_read.rego","text":""},{"location":"policies/storage.html#mgcstorage007-disallow-public-write-access-on-object-storage-buckets","title":"MGC.STORAGE.007: Disallow public write access on Object Storage Buckets","text":"<p>Severity: !!! critical \"CRITICAL\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects 'mgc_object_storage_buckets' that allow public write access.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_deny_public_writerego","title":"Source Code: mgc_storage_deny_public_write.rego","text":""},{"location":"policies/storage.html#mgcstorage008-ensure-versioning-is-enabled-on-object-storage-buckets","title":"MGC.STORAGE.008: Ensure versioning is enabled on Object Storage Buckets","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Storage</code></p> <p>Description: Detects 'mgc_object_storage_buckets' that do not have 'enable_versioning = true'.</p>"},{"location":"policies/storage.html#source-code-mgc_storage_enforce_bucket_versioningrego","title":"Source Code: mgc_storage_enforce_bucket_versioning.rego","text":""},{"location":"policies/virtualmachine.html","title":"Virtualmachine Policies","text":""},{"location":"policies/virtualmachine.html#mgcvm001-disallow-public-ip-allocation-on-vm-instances","title":"MGC.VM.001: Disallow public IP allocation on VM instances","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects 'mgc_virtual_machine_instances' that are configured to allocate a public IP on boot.</p> <p>Pending Provider Enhancement</p> <p>This policy targets a <code>write-only</code> attribute (<code>allocate_public_ipv4</code>) in the Terraform provider.  Static analysis tools like Conftest may not be able to reliably detect this attribute in the generated plan file (<code>tfplan.json</code>).  Full enforcement of this policy is pending a provider update to make this attribute consistently visible in the plan's output.</p>"},{"location":"policies/virtualmachine.html#source-code-mgc_vm_disallow_public_iprego","title":"Source Code: mgc_vm_disallow_public_ip.rego","text":""},{"location":"policies/virtualmachine.html#mgcvm002-ensure-vm-instances-explicitly-define-security-groups","title":"MGC.VM.002: Ensure VM instances explicitly define Security Groups","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects 'mgc_virtual_machine_instances' that do not define 'creation_security_groups', resulting in using the VPC default.</p>"},{"location":"policies/virtualmachine.html#source-code-mgc_vm_ensure_explicit_security_grouprego","title":"Source Code: mgc_vm_ensure_explicit_security_group.rego","text":""},{"location":"policies/virtualmachine.html#mgcvm003-ensure-non-windows-vm-instances-have-an-associated-ssh-key","title":"MGC.VM.003: Ensure non-Windows VM instances have an associated SSH Key","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects non-Windows 'mgc_virtual_machine_instances' that do not define a 'ssh_key_name'.</p>"},{"location":"policies/virtualmachine.html#source-code-mgc_vm_ensure_ssh_keyrego","title":"Source Code: mgc_vm_ensure_ssh_key.rego","text":""},{"location":"policies/virtualmachine.html#mgcvm004-disallow-manual-snapshots-of-vm-instances","title":"MGC.VM.004: Disallow manual snapshots of VM instances","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects the use of manual VM snapshots ('mgc_virtual_machine_snapshots'). Prefer automated block storage backup schedules.</p>"},{"location":"policies/virtualmachine.html#source-code-mgc_vm_disallow_manual_snapshotsrego","title":"Source Code: mgc_vm_disallow_manual_snapshots.rego","text":""},{"location":"policies/vm.html","title":"Virtualmachine Policies","text":""},{"location":"policies/vm.html#mgcvm001-disallow-public-ip-allocation-on-vm-instances","title":"MGC.VM.001: Disallow public IP allocation on VM instances","text":"<p>Severity: !!! danger \"HIGH\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects 'mgc_virtual_machine_instances' that are configured to allocate a public IP on boot.</p> <p>Pending Provider Enhancement</p> <p>This policy targets a <code>write-only</code> attribute (<code>allocate_public_ipv4</code>) in the Terraform provider.  Static analysis tools like Conftest may not be able to reliably detect this attribute in the generated plan file (<code>tfplan.json</code>).  Full enforcement of this policy is pending a provider update to make this attribute consistently visible in the plan's output.</p>"},{"location":"policies/vm.html#source-code-mgc_vm_disallow_public_iprego","title":"Source Code: mgc_vm_disallow_public_ip.rego","text":""},{"location":"policies/vm.html#mgcvm002-ensure-vm-instances-explicitly-define-security-groups","title":"MGC.VM.002: Ensure VM instances explicitly define Security Groups","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects 'mgc_virtual_machine_instances' that do not define 'creation_security_groups', resulting in using the VPC default.</p>"},{"location":"policies/vm.html#source-code-mgc_vm_ensure_explicit_security_grouprego","title":"Source Code: mgc_vm_ensure_explicit_security_group.rego","text":""},{"location":"policies/vm.html#mgcvm003-ensure-non-windows-vm-instances-have-an-associated-ssh-key","title":"MGC.VM.003: Ensure non-Windows VM instances have an associated SSH Key","text":"<p>Severity: !!! warning \"MEDIUM\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects non-Windows 'mgc_virtual_machine_instances' that do not define a 'ssh_key_name'.</p>"},{"location":"policies/vm.html#source-code-mgc_vm_ensure_ssh_keyrego","title":"Source Code: mgc_vm_ensure_ssh_key.rego","text":""},{"location":"policies/vm.html#mgcvm004-disallow-manual-snapshots-of-vm-instances","title":"MGC.VM.004: Disallow manual snapshots of VM instances","text":"<p>Severity: !!! info \"LOW\"</p> <p>Category: <code>Virtual Machine</code></p> <p>Description: Detects the use of manual VM snapshots ('mgc_virtual_machine_snapshots'). Prefer automated block storage backup schedules.</p>"},{"location":"policies/vm.html#source-code-mgc_vm_disallow_manual_snapshotsrego","title":"Source Code: mgc_vm_disallow_manual_snapshots.rego","text":""}]}